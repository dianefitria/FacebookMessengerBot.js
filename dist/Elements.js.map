{"version":3,"sources":["../src/Elements.js"],"names":["Elements","_elements","_quickreplies","_listStyle","_buttons","text","image","subtext","url","buttons","Array","isArray","from","Error","push","quickreplies","listStyle","build","length","elements","e","element","title","image_url","subtitle","item_url","toJSON","attachment","type","payload","template_type","top_element_style","built","quick_replies"],"mappings":"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","file":"Elements.js","sourcesContent":["import Buttons from './Buttons';\r\nimport QuickReplies from './QuickReplies';\r\n\r\nclass Elements {\r\n  constructor() {\r\n    this._elements = [];\r\n    this._quickreplies = null;\r\n    this._listStyle = null;\r\n    this._buttons = null;\r\n  }\r\n\r\n  add({\r\n    text,\r\n    image,\r\n    subtext,\r\n    url,\r\n    buttons\r\n  }) {\r\n    if (buttons) {\r\n      if (!(buttons instanceof Buttons)) {\r\n        if (Array.isArray(buttons)) {\r\n          buttons = Buttons.from(buttons);\r\n        } else {\r\n          throw Error('Unable to parse buttons');\r\n        }\r\n      }\r\n    }\r\n\r\n    this._elements.push({\r\n      text,\r\n      image,\r\n      subtext,\r\n      url,\r\n      buttons\r\n    });\r\n    return this;\r\n  }\r\n\r\n  setQuickReplies(quickreplies) {\r\n    if (quickreplies) {\r\n      if (!(quickreplies instanceof QuickReplies)) {\r\n        if (Array.isArray(quickreplies)) {\r\n          quickreplies = QuickReplies.from(quickreplies);\r\n        } else {\r\n          throw Error('Unable to parse quickreplies');\r\n        }\r\n      }\r\n    }\r\n\r\n    this._quickreplies = quickreplies;\r\n  }\r\n\r\n  setListStyle(listStyle, buttons) {\r\n    if (listStyle === 'large' || listStyle === 'compact') {\r\n      this._listStyle = listStyle;\r\n    } else {\r\n      throw Error('Valid values for list styles are \"large\" or \"compact\"');\r\n    }\r\n\r\n    if (buttons) {\r\n      if (!(buttons instanceof Buttons)) {\r\n        if (Array.isArray(buttons)) {\r\n          this._buttons = Buttons.from(buttons);\r\n        } else {\r\n          throw Error('Unable to parse buttons');\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  getQuickReplies() {\r\n    return this._quickreplies;\r\n  }\r\n\r\n  get length() {\r\n    return this._elements.length;\r\n  }\r\n\r\n  toJSON() {\r\n    const build = () => {\r\n      if (this._elements.length > 1) {\r\n        const elements = [];\r\n        for (const e of this._elements) {\r\n          const element = {};\r\n          if (e.text) element.title = e.text;\r\n          if (e.image) element.image_url = e.image;\r\n          if (e.subtext) element.subtitle = e.subtext;\r\n          if (e.url) element.item_url = e.url;\r\n          if (e.buttons && e.buttons.length) element.buttons = e.buttons.toJSON();\r\n          elements.push(element);\r\n        }\r\n\r\n        let buttons;\r\n        if (this._buttons && e._buttons.length) {\r\n          buttons = this._buttons.toJSON();\r\n        }\r\n\r\n        if (this._listStyle) {\r\n          return {\r\n            attachment: {\r\n              type: 'template',\r\n              payload: {\r\n                template_type: 'list',\r\n                top_element_style: this._listStyle,\r\n                elements,\r\n                buttons\r\n              }\r\n            }\r\n          };\r\n        } else if (!this._listStyle) {\r\n          return {\r\n            attachment: {\r\n              type: 'template',\r\n              payload: {\r\n                template_type: 'generic',\r\n                elements\r\n              }\r\n            }\r\n          };\r\n        }\r\n      } else if (this._elements.length === 1) {\r\n        const e = this._elements[0];\r\n        const element = {};\r\n        if (e.text && e.buttons && e.buttons.length && (e.image || e.subtext)) {\r\n          element.title = e.text;\r\n          if (e.image) element.image_url = e.image;\r\n          if (e.subtext) element.subtitle = e.subtext;\r\n          element.buttons = e.buttons.toJSON();\r\n          return {\r\n            attachment: {\r\n              type: 'template',\r\n              payload: {\r\n                template_type: 'generic',\r\n                elements: [element]\r\n              }\r\n            }\r\n          };\r\n        } else if (e.text && e.buttons && e.buttons.length) {\r\n          element.text = e.text;\r\n          if (e.image) element.image_url = e.image;\r\n          element.buttons = e.buttons.toJSON();\r\n          return {\r\n            attachment: {\r\n              type: 'template',\r\n              payload: {\r\n                template_type: 'button',\r\n                ...element\r\n              }\r\n            }\r\n          };\r\n        } else if (e.text) {\r\n          return {\r\n            text: e.text\r\n          };\r\n        } else if (e.image) {\r\n          return {\r\n            attachment: {\r\n              type: 'image',\r\n              payload: {\r\n                url: e.image\r\n              }\r\n            }\r\n          };\r\n        }\r\n      }\r\n\r\n      throw Error('Could not form a message. Have you followed the format?');\r\n    };\r\n\r\n    const built = build();\r\n\r\n    if (this._quickreplies && this._quickreplies.length) {\r\n      built.quick_replies = this._quickreplies.toJSON();\r\n    }\r\n\r\n    return built;\r\n  }\r\n}\r\n\r\nexport default Elements;"]}